# ASSO MVP - 구현된 기능

## ✅ 완료된 기능

### 1. Case 관리
- [x] 사건 생성 (기본 정보 + 사용자 컨텍스트)
- [x] 사건 목록 조회
- [x] 사건 상세 페이지
- [x] 사건 수정
- [x] 사건 삭제

### 2. 문서 관리
- [x] PDF 업로드 (다중)
- [x] Upstage OCR 자동 실행
- [x] 문서 목록 표시
- [x] 문서 삭제 (Soft Delete)
- [x] PDF 보기 (새 탭)

### 3. AI 분석
- [x] Gemini 2.5 Flash 통합
- [x] 사용자 컨텍스트 반영
  - 대리인 구분 (피고인/피해자)
  - 사건 배경, 주장, 중점 사항
- [x] 다중 문서 통합 분석
- [x] 분석 결과 구조화
  - 사건 요약
  - 쟁점
  - 타임라인 (페이지 번호 포함)
  - 증거 목록 (페이지 번호 포함)
  - 유리한 정황
  - 모순점

### 4. 분석 결과 관리
- [x] 분석 히스토리
- [x] 분석 제목 자동 생성 ("파일명 외 2개")
- [x] 분석 제목 수정
- [x] 분석 결과 삭제 (Soft Delete)
- [x] 분석 선택 및 표시
- [x] **분석 결과 메모/코멘트**
  - 타임라인 이벤트별 메모 (선택)
  - 증거 항목별 메모 (선택)
  - 보기 모드에서 메모 표시
- [x] **분석 결과 비교**
  - 2개 분석 선택 후 나란히 비교 (요약, 쟁점, 타임라인, 증거, 유리한 정황, 모순점)
  - **차이 강조** 토글: 시간순(created_at) 기준 삭제됨/추가됨/수정됨
  - 요약 단어 단위 diff, 리스트·타임라인·증거 뱃지 표시
- [x] **AI 수정 시 새 분석으로 저장**
  - 수정 전 분석은 유지, 수정 결과는 "[AI 수정] 제목"으로 새 항목 추가
  - 수정 전/후 분석 비교 가능

### 5. 편집 기능
- [x] 타임라인 직접 편집
  - 이벤트 추가/수정/삭제
  - 이벤트별 메모 (note)
- [x] 증거 목록 편집
  - 증거 추가/수정/삭제
  - 증거별 메모 (note)
- [x] AI 수정 요청
  - 자연어로 수정 요청
  - 기존 분석 기반 수정 → **결과는 새 분석으로 저장**
- [x] 저장 기능

### 6. 원문 키워드 검색
- [x] 사건 소속 문서 청크에서 키워드 검색
- [x] 검색 결과 클릭 시 PDF + 원문 인라인 표시 (해당 페이지로 이동)
- [x] 원문 텍스트에 검색어 하이라이트
- [x] **PDF 실제 페이지 번호 사용** (Upstage elements 기반, 새 업로드 문서부터 적용)

### 7. 증거기록 분류·분석
- [x] 문서별 "증거기록 분류" 버튼 (텍스트 기반 AI 분류)
- [x] 페이지별 증거 유형 분류 (증거목록, 진술조서, 계좌내역, 사진 증거 등)
- [x] 연속 같은 유형 → 증거 섹션 그룹핑
- [x] OCR 불가 섹션: 사용자 설명·태그 입력
- [x] 증거 섹션별 개별 분석 (유형별 프롬프트)
- [x] 분류 결과 수정, 분석 결과 표시
- [x] **Vision으로 설명 생성** (사진 증거·OCR 불가 섹션)
  - 해당 PDF 페이지를 이미지로 Gemini Vision에 전달 → 객관적 설명 생성 후 `vision_description` 저장
  - 개별 분석 시 원문 + Vision 설명 + 메모를 함께 참고
  - UI: 확장 시 Vision 설명 블록 표시, "Vision으로 설명 생성" / "Vision 재생성" 버튼

### 8. UI/UX
- [x] Timeline 시각화
- [x] Toast 알림
- [x] Dialog 확인
- [x] Loading 상태
- [x] 페이지 번호 표시
- [x] 분석 비교 뷰 (차이 강조 on/off)

## ⏳ 보류/미구현

### RAG/청킹 시스템
- 이유: 복잡도 대비 효과 미미
- 상태: 베타 피드백 후 재검토

### Few-shot Learning
- 이유: Supabase RLS 미설정 시 접근 불가
- 상태: RLS 설정 시 재활성화 가능 (`docs/SUPABASE_FEW_SHOT_SETUP.md`)
